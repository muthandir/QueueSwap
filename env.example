# Application Configuration
NODE_ENV=development
PORT=3000

# Queue Provider: sqs | rabbitmq | all | conditional
# - sqs: Use AWS SQS only
# - rabbitmq: Use RabbitMQ only
# - all: Publish to all configured queues (dual-write pattern)
# - conditional: Route based on message content (e.g., data residency)
QUEUE_PROVIDER=sqs

# ==========================================
# Consumer Configuration
# ==========================================
# Enable/disable the background consumer
CONSUMER_ENABLED=true
# How often to poll for messages (milliseconds)
CONSUMER_POLL_INTERVAL_MS=5000
# Maximum messages to fetch per poll
CONSUMER_MAX_MESSAGES_PER_POLL=10
# Message visibility timeout (seconds)
CONSUMER_VISIBILITY_TIMEOUT=30
# Long polling wait time (seconds)
CONSUMER_WAIT_TIME_SECONDS=10

# ==========================================
# AWS SQS Configuration (when QUEUE_PROVIDER=sqs or all)
# ==========================================
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=test
AWS_SECRET_ACCESS_KEY=test
# For LocalStack, set AWS_ENDPOINT. For real AWS, leave it empty or remove this line
AWS_ENDPOINT=http://localhost:4566
SQS_QUEUE_URL=http://localhost:4566/000000000000/test-queue

# ==========================================
# RabbitMQ Configuration (when QUEUE_PROVIDER=rabbitmq or all)
# ==========================================
RABBITMQ_URL=amqp://guest:guest@localhost:5672
RABBITMQ_QUEUE_NAME=test-queue

# ==========================================
# Example Configurations:
# ==========================================

# For SQS only (LocalStack):
# QUEUE_PROVIDER=sqs
# CONSUMER_ENABLED=true
# AWS_ENDPOINT=http://localhost:4566
# SQS_QUEUE_URL=http://localhost:4566/000000000000/test-queue

# For RabbitMQ only:
# QUEUE_PROVIDER=rabbitmq
# CONSUMER_ENABLED=true
# RABBITMQ_URL=amqp://guest:guest@localhost:5672
# RABBITMQ_QUEUE_NAME=test-queue

# For all queues simultaneously (global dual-write):
# QUEUE_PROVIDER=all
# CONSUMER_ENABLED=true
# (include all configurations from above)

# For module-specific queue selection with forFeature():
# PrescriptionsModule uses forFeature({ provider: 'conditional' })
# This means prescriptions ALWAYS use conditional routing regardless
# of the global QUEUE_PROVIDER setting:
#   - Turkish orders (country='TR') → RabbitMQ
#   - All other orders → SQS
# 
# You MUST configure ALL queue types (SQS and RabbitMQ) for this to work.
# 
# Example: Set global to 'rabbitmq', but prescriptions still route conditionally
# QUEUE_PROVIDER=rabbitmq  # NotificationsModule uses this
# (Prescriptions ignore this and use their own conditional routing)

# For conditional routing (data residency compliance):
# QUEUE_PROVIDER=conditional
# Routes messages based on content (e.g., country='TR' → RabbitMQ)
# Requires all queue configurations above
# Use case: Turkish banking regulations require data to stay in Turkey

# To disable consumer (use REST API only):
# CONSUMER_ENABLED=false
